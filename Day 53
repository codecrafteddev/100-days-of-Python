from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
import time

SIMILAR_ACCOUNT = "target_account_here"  # The Instagram account whose followers you want to follow
USERNAME = "your_instagram_username"
PASSWORD = "your_instagram_password"

class InstaFollower:

    def __init__(self):
        # Optional: Keep browser open after script ends (useful for debugging)
        chrome_options = webdriver.ChromeOptions()
        chrome_options.add_experimental_option("detach", True)
        self.driver = webdriver.Chrome(options=chrome_options)

    def login(self):
        self.driver.get("https://www.instagram.com/accounts/login/")
        time.sleep(3)

        # Dismiss cookie popup if exists
        try:
            cookie_button = self.driver.find_element(By.XPATH, "//button[contains(text(), 'Accept')]")
            cookie_button.click()
            time.sleep(2)
        except:
            pass

        # Enter username and password
        username_input = self.driver.find_element(By.NAME, "username")
        password_input = self.driver.find_element(By.NAME, "password")
        username_input.send_keys(USERNAME)
        password_input.send_keys(PASSWORD)
        password_input.send_keys(Keys.ENTER)
        time.sleep(5)

        # Dismiss "Save Your Login Info?" popup
        try:
            save_info_not_now = self.driver.find_element(By.XPATH, "//button[contains(text(), 'Not Now')]")
            save_info_not_now.click()
            time.sleep(2)
        except:
            pass

        # Dismiss "Turn on Notifications" popup
        try:
            notifications_not_now = self.driver.find_element(By.XPATH, "//button[contains(text(), 'Not Now')]")
            notifications_not_now.click()
            time.sleep(2)
        except:
            pass

    def find_followers(self):
        self.driver.get(f"https://www.instagram.com/{SIMILAR_ACCOUNT}/")
        time.sleep(3)

        followers_link = self.driver.find_element(By.PARTIAL_LINK_TEXT, "followers")
        followers_link.click()
        time.sleep(2)

        # Popup containing followers
        popup = self.driver.find_element(By.XPATH, "//div[@role='dialog']//ul")
        
        # Scroll popup to load more followers (adjust scroll count as needed)
        for _ in range(10):
            self.driver.execute_script("arguments[0].scrollTop = arguments[0].scrollHeight", popup)
            time.sleep(2)

    def follow(self):
        # Find all follow buttons on the popup
        follow_buttons = self.driver.find_elements(By.XPATH, "//button[text()='Follow']")
        for button in follow_buttons:
            try:
                button.click()
                time.sleep(1)
            except:
                # Skip if button not clickable or already followed
                pass

# Instantiate and run the bot
bot = InstaFollower()
bot.login()
bot.find_followers()
bot.follow()
